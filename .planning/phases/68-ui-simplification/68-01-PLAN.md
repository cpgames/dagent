---
phase: 68-ui-simplification
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/renderer/src/components/DAG/TaskNode.tsx
  - src/renderer/src/components/Feature/FeatureSpecViewer.tsx
  - src/renderer/src/views/DAGView.tsx
autonomous: true
must_haves:
  truths:
    - "TaskNode no longer shows 'LOOP X/Y' badge during execution"
    - "TaskNode shows clean status progression (DEV, QA, MERGE badges)"
    - "Detailed logs remain accessible via task log dialog"
    - "Feature spec is viewable in the UI when available"
  artifacts:
    - path: "src/renderer/src/components/DAG/TaskNode.tsx"
      provides: "Simplified task node without iteration counter"
      contains: "stateBadgeConfig"
    - path: "src/renderer/src/components/Feature/FeatureSpecViewer.tsx"
      provides: "Feature specification viewer component"
      min_lines: 50
      exports: ["FeatureSpecViewer", "FeatureSpecViewerProps"]
  key_links:
    - from: "src/renderer/src/views/DAGView.tsx"
      to: "FeatureSpecViewer"
      via: "import and render"
      pattern: "FeatureSpecViewer"
---

<objective>
Simplify UI by removing confusing iteration counters and adding feature spec visibility.

Purpose: Improve user experience by hiding implementation details (loop iterations) while adding visibility into feature requirements through a spec viewer.
Output: Cleaner TaskNode component and new FeatureSpecViewer component integrated into DAGView.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/67-context-checkpointing/67-01-SUMMARY.md

@src/renderer/src/components/DAG/TaskNode.tsx
@src/renderer/src/views/DAGView.tsx
@src/main/agents/feature-spec-types.ts
@src/preload/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove loop iteration badge from TaskNode</name>
  <files>src/renderer/src/components/DAG/TaskNode.tsx</files>
  <action>
Remove the loop iteration badge section (lines 156-183) that displays "LOOP X/Y" to users.
This includes:
1. Remove the entire block starting with `{loopStatus && loopStatus.status === 'running' && (`
2. The checklist mini-icons within that block should also be removed
3. Keep the `loopStatus` prop in TaskNodeData for potential debugging use but don't render it
4. Keep the existing DEV/QA/MERGE state badges (stateBadgeConfig) - these provide useful status without confusing iteration details

The goal is to hide implementation details from users while keeping clean status progression visible.
  </action>
  <verify>npm run typecheck && npm run build</verify>
  <done>TaskNode no longer renders "LOOP X/Y" badge but still shows DEV/QA/MERGE status badges</done>
</task>

<task type="auto">
  <name>Task 2: Create FeatureSpecViewer component</name>
  <files>src/renderer/src/components/Feature/FeatureSpecViewer.tsx</files>
  <action>
Create a new component to display feature specifications:

```typescript
import { useState, useEffect, type JSX } from 'react'
import type { FeatureSpec } from '../../../../main/agents/feature-spec-types'

export interface FeatureSpecViewerProps {
  featureId: string
  className?: string
}

export function FeatureSpecViewer({ featureId, className = '' }: FeatureSpecViewerProps): JSX.Element | null
```

Component requirements:
1. Load spec using `window.electronAPI.pmSpec.getSpec({ featureId })`
2. Poll for updates every 5 seconds when spec exists
3. Display sections:
   - Goals (bullet list)
   - Requirements (checkable list showing completion status)
   - Constraints (bullet list)
   - Acceptance Criteria (checkable list showing passed status)
4. If no spec exists, return null (don't show anything)
5. Collapsible sections with chevron toggles
6. Dark theme styling consistent with existing UI (bg-gray-800, text colors)
7. Compact layout suitable for sidebar placement
  </action>
  <verify>npm run typecheck && npm run build</verify>
  <done>FeatureSpecViewer component created with all sections and loading from IPC</done>
</task>

<task type="auto">
  <name>Task 3: Integrate FeatureSpecViewer into DAGView</name>
  <files>src/renderer/src/views/DAGView.tsx</files>
  <action>
Add FeatureSpecViewer to the chat sidebar area in DAGView:

1. Import the new component at the top
2. Add state to toggle spec viewer visibility: `const [showSpec, setShowSpec] = useState(false)`
3. Add a toggle button near the chat panel header or in ExecutionControls
4. Render FeatureSpecViewer above or as a collapsible section within the chat sidebar when activeFeatureId is set
5. Pass featureId to the viewer

Placement suggestion: Add a small tab or toggle button that shows/hides the spec viewer as a collapsible panel above the chat input, since both relate to the feature context.

Keep it simple - just the viewer component rendered conditionally based on toggle state.
  </action>
  <verify>npm run typecheck && npm run build</verify>
  <done>FeatureSpecViewer integrated into DAGView and accessible via toggle</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run typecheck` passes
- [ ] `npm run build` succeeds
- [ ] TaskNode no longer shows "LOOP X/Y" text
- [ ] DEV/QA/MERGE badges still appear in TaskNode
- [ ] FeatureSpecViewer component exists and exports correctly
- [ ] DAGView imports and conditionally renders FeatureSpecViewer
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No TypeScript errors
- Loop counter removed from user-facing UI
- Spec viewer available for features with specs
</success_criteria>

<output>
After completion, create `.planning/phases/68-ui-simplification/68-01-SUMMARY.md`
</output>
