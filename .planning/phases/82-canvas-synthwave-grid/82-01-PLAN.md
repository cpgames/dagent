---
phase: 82-canvas-synthwave-grid
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [src/renderer/src/components/Background/SynthwaveGrid.tsx, src/renderer/src/components/Background/SynthwaveGrid.css, src/renderer/src/components/Background/Horizon.tsx, src/renderer/src/components/Background/Horizon.css, src/renderer/src/components/Background/SynthwaveBackground.tsx]
autonomous: true

must_haves:
  truths:
    - "Canvas grid renders curved horizontal lines following horizon curvature"
    - "Grid animates smoothly scrolling toward viewer"
    - "Grid respects reduced motion preference (static fallback)"
    - "Grid integrates seamlessly with existing horizon glow"
  artifacts:
    - path: "src/renderer/src/components/Background/SynthwaveGrid.tsx"
      provides: "Canvas-based synthwave grid component"
      min_lines: 80
    - path: "src/renderer/src/components/Background/SynthwaveGrid.css"
      provides: "Styling for canvas container"
      min_lines: 10
  key_links:
    - from: "src/renderer/src/components/Background/SynthwaveBackground.tsx"
      to: "SynthwaveGrid"
      via: "component import and render"
      pattern: "import.*SynthwaveGrid"
---

<objective>
Create a canvas-based synthwave grid with curved horizontal lines and scrolling animation.

Purpose: Replace the CSS-based perspective grid with a proper canvas implementation that can render truly curved lines following the elliptical horizon curvature, with smooth animation effects.

Output: SynthwaveGrid component with canvas rendering, animation loop, and integration into the background system.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@src/renderer/src/components/Background/Horizon.tsx
@src/renderer/src/components/Background/Horizon.css
@src/renderer/src/components/Background/SynthwaveBackground.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SynthwaveGrid canvas component</name>
  <files>src/renderer/src/components/Background/SynthwaveGrid.tsx, src/renderer/src/components/Background/SynthwaveGrid.css</files>
  <action>
Create a new SynthwaveGrid component that renders a canvas-based perspective grid:

1. Create SynthwaveGrid.tsx with:
   - Canvas element filling the bottom portion of the viewport
   - useRef for canvas element
   - useEffect for animation loop with requestAnimationFrame
   - Grid state: animation offset for scrolling effect
   - Draw function that renders:
     a) Curved horizontal lines - use quadratic bezier curves matching horizon ellipse curvature
     b) Vertical lines converging toward a vanishing point at horizon
     c) Cyan (#00f0ff) for horizontal lines, magenta (#ff00ff) for vertical lines
     d) Line opacity fading toward horizon (top of canvas)
   - Animation: horizontal lines scroll toward viewer (offset increases over time)
   - Cleanup: cancel animation frame on unmount

2. Create SynthwaveGrid.css with:
   - Fixed positioning at bottom of viewport
   - Appropriate z-index (below content, above base background)
   - pointer-events: none

3. Props interface:
   - speed?: number (animation speed, default 1)
   - lineCount?: number (number of horizontal lines, default 15)
   - className?: string

4. Reduced motion support:
   - Check window.matchMedia('(prefers-reduced-motion: reduce)')
   - If reduced motion, render static grid (no animation)
  </action>
  <verify>npm run build</verify>
  <done>SynthwaveGrid component renders canvas with curved grid lines and animation</done>
</task>

<task type="auto">
  <name>Task 2: Integrate SynthwaveGrid and update Horizon</name>
  <files>src/renderer/src/components/Background/SynthwaveBackground.tsx, src/renderer/src/components/Background/Horizon.tsx, src/renderer/src/components/Background/Horizon.css</files>
  <action>
1. Update SynthwaveBackground.tsx:
   - Import SynthwaveGrid component
   - Replace grid prop logic to use SynthwaveGrid instead of Horizon's CSS grid
   - Render SynthwaveGrid when grid=true
   - Keep Horizon but always pass showGrid={false} (Horizon handles the glow, not the grid)

2. Update Horizon.tsx:
   - Remove the SVG filter definitions (no longer needed)
   - Keep showGrid prop for backwards compatibility but consider deprecating
   - Simplify component to just render horizon line and reflection

3. Update Horizon.css:
   - Remove .horizon__grid styles (moved to canvas)
   - Remove .horizon__filters styles
   - Keep horizon line, reflection, and glow styles intact

4. Ensure canvas grid aligns visually with horizon:
   - Grid should appear to recede toward the horizon line
   - Vanishing point should be at the center-top of the canvas (horizon level)
   - First horizontal line should start just below where the CSS grid used to begin
  </action>
  <verify>npm run build && npm run dev (visual inspection)</verify>
  <done>SynthwaveGrid integrated, CSS grid removed, horizon glow preserved</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] SynthwaveGrid.tsx exists with canvas rendering logic
- [ ] Grid lines are curved (quadratic bezier matching horizon)
- [ ] Animation scrolls grid toward viewer smoothly
- [ ] Reduced motion support works (static fallback)
- [ ] Horizon glow effects still render correctly
- [ ] No visual gaps between grid and horizon
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Canvas grid replaces CSS grid with curved lines
- Animation is smooth and performant
- Grid integrates seamlessly with horizon glow
</success_criteria>

<output>
After completion, create `.planning/phases/82-canvas-synthwave-grid/82-01-SUMMARY.md`
</output>
