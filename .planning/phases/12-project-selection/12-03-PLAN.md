---
phase: 12-project-selection
plan: 03
type: execute
---

<objective>
Add recent projects list with persistence and integrate project selection into app startup flow.

Purpose: Enable quick access to recently opened projects and show project selection on first launch.
Output: Recent projects storage, updated ProjectSelectionDialog with recent list, startup integration in App.tsx.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./12-03-SUMMARY.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-project-selection/12-01-SUMMARY.md
@.planning/phases/12-project-selection/12-02-SUMMARY.md

@src/main/ipc/project-handlers.ts
@src/preload/index.ts
@src/renderer/src/stores/project-store.ts
@src/renderer/src/components/Project/ProjectSelectionDialog.tsx
@src/renderer/src/App.tsx

**Tech stack available:** electron-store (or app.getPath('userData')), Zustand
**Established patterns:** IPC handlers, Zustand stores, Dialog components
**Constraining decisions:**
- Recent projects stored in user data directory (not in project .dagent)
- Maximum 10 recent projects
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add recent projects storage in main process</name>
  <files>src/main/storage/recent-projects.ts, src/main/ipc/project-handlers.ts</files>
  <action>
1. Create recent-projects.ts:
   - Use path.join(app.getPath('userData'), 'recent-projects.json')
   - RecentProject type: { path: string, name: string, lastOpened: string }
   - getRecentProjects(): Promise<RecentProject[]> - read file, return [] if not exist
   - addRecentProject(path, name): Promise<void> - add to front, remove duplicates, limit to 10, save
   - removeRecentProject(path): Promise<void> - remove from list, save
   - clearRecentProjects(): Promise<void> - empty the list

2. Add IPC handlers in project-handlers.ts:
   - `project:get-recent` - return recent projects list
   - `project:add-recent` - add project to recent (called after opening project)
   - `project:remove-recent` - remove from recent list
   - `project:clear-recent` - clear all recent projects

Update project:set-project handler to also call addRecentProject after successful init.
Update project:create handler to also call addRecentProject after creation.
  </action>
  <verify>Build succeeds: npm run build</verify>
  <done>Recent projects stored in userData, IPC handlers for CRUD operations</done>
</task>

<task type="auto">
  <name>Task 2: Add recent projects API to preload and store</name>
  <files>src/preload/index.ts, src/renderer/src/stores/project-store.ts</files>
  <action>
1. Add to project namespace in preload:
```typescript
getRecent: (): Promise<Array<{ path: string; name: string; lastOpened: string }>> =>
  ipcRenderer.invoke('project:get-recent'),
removeRecent: (path: string): Promise<void> =>
  ipcRenderer.invoke('project:remove-recent', path),
clearRecent: (): Promise<void> =>
  ipcRenderer.invoke('project:clear-recent')
```

2. Update project-store.ts:
   - Add recentProjects state: Array<{ path, name, lastOpened }>
   - Add loadRecentProjects() action - fetch from IPC
   - Add removeFromRecent(path) action
   - Modify openProject to call loadRecentProjects after success (list updated in main)
  </action>
  <verify>TypeScript compiles without errors</verify>
  <done>Recent projects API exposed, project-store has recentProjects state and actions</done>
</task>

<task type="auto">
  <name>Task 3: Update dialogs and integrate startup flow</name>
  <files>src/renderer/src/components/Project/ProjectSelectionDialog.tsx, src/renderer/src/App.tsx</files>
  <action>
1. Update ProjectSelectionDialog.tsx:
   - Add recent projects list section above buttons
   - Fetch recent projects on mount using loadRecentProjects
   - Display as clickable list items with folder icon, project name, path (truncated)
   - Click opens that project (call openProject)
   - Add small X button on each to remove from recent (call removeFromRecent)
   - If no recent projects, show "No recent projects" text
   - Keep "Open Folder" and "Create New Project" buttons at bottom

2. Update App.tsx:
   - Import ProjectSelectionDialog and NewProjectDialog from components/Project
   - Add projectSelectionDialogOpen state (default false)
   - Add newProjectDialogOpen state (default false)
   - On mount: check if project is loaded (project-store). If not, show ProjectSelectionDialog
   - Wire "Create New Project" button in ProjectSelectionDialog to open NewProjectDialog
   - On project open success: close dialogs, reload features
   - Add "Open Project..." option to header (or menu) that opens ProjectSelectionDialog
  </action>
  <verify>npm run build succeeds, npm run dev shows project selection on startup if no project</verify>
  <done>ProjectSelectionDialog shows recent projects list, startup flow shows dialog when no project, can switch projects from UI</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] Recent projects persisted to userData directory
- [ ] ProjectSelectionDialog shows recent projects list
- [ ] Can click recent project to open it
- [ ] Can remove project from recent list
- [ ] Startup shows project selection if appropriate
- [ ] Can open project selection from header/menu
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No TypeScript errors
- Recent projects list populated and functional
- App shows project selection on startup
- Phase 12 complete
</success_criteria>

<output>
After completion, create `.planning/phases/12-project-selection/12-03-SUMMARY.md`
</output>
