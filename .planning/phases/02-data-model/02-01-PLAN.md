---
phase: 02-data-model
plan: 01
type: execute
---

<objective>
Define core TypeScript interfaces matching DAGENT_SPEC.md data model.

Purpose: Establish type-safe foundation for all data operations - every component will use these types.
Output: Type definitions in src/shared/types/ directory, importable from main and renderer.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./02-01-SUMMARY.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation/01-03-SUMMARY.md
@DAGENT_SPEC.md (sections 4.1-4.6 for data model)

**Tech stack available:** Electron, React, TypeScript, Tailwind, electron-vite
**Established patterns:** IPC via contextBridge, main/preload/renderer separation
**Key files:** src/main/index.ts, src/preload/index.ts, src/renderer/src/App.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create shared types directory and core interfaces</name>
  <files>src/shared/types/index.ts, src/shared/types/feature.ts, src/shared/types/task.ts, src/shared/types/connection.ts, src/shared/types/dag.ts</files>
  <action>
Create src/shared/types/ directory for types shared between main and renderer.

Create feature.ts with:
```typescript
export type FeatureStatus = 'not_started' | 'in_progress' | 'needs_attention' | 'completed';

export interface Feature {
  id: string;
  name: string;
  status: FeatureStatus;
  branchName: string;
  createdAt: string;  // ISO timestamp
  updatedAt: string;  // ISO timestamp
}
```

Create task.ts with:
```typescript
export type TaskStatus = 'blocked' | 'ready' | 'running' | 'merging' | 'completed' | 'failed';

export interface TaskPosition {
  x: number;
  y: number;
}

export interface Task {
  id: string;
  title: string;
  description: string;
  status: TaskStatus;
  locked: boolean;
  position: TaskPosition;
}
```

Create connection.ts with:
```typescript
export interface Connection {
  from: string;  // Source task ID
  to: string;    // Target task ID (depends on source)
}
```

Create dag.ts with:
```typescript
import type { Task } from './task';
import type { Connection } from './connection';

export interface DAGGraph {
  nodes: Task[];
  connections: Connection[];
}
```

Create index.ts that re-exports all types:
```typescript
export * from './feature';
export * from './task';
export * from './connection';
export * from './dag';
```
  </action>
  <verify>TypeScript compiles: npm run typecheck passes</verify>
  <done>All core types defined matching DAGENT_SPEC.md sections 4.1-4.4</done>
</task>

<task type="auto">
  <name>Task 2: Create chat and log types</name>
  <files>src/shared/types/chat.ts, src/shared/types/log.ts, src/shared/types/index.ts</files>
  <action>
Create chat.ts with:
```typescript
export interface ChatEntry {
  role: 'user' | 'assistant';
  content: string;
  media?: string[];  // Relative paths to attached files
  timestamp: string; // ISO timestamp
}

export interface ChatHistory {
  entries: ChatEntry[];
}
```

Create log.ts with:
```typescript
export type LogEntryType = 'intention' | 'approval' | 'rejection' | 'modification' | 'action' | 'error';
export type AgentType = 'harness' | 'task' | 'merge';

export interface LogEntry {
  timestamp: string;
  type: LogEntryType;
  agent: AgentType;
  taskId?: string;
  content: string;
}

export interface AgentLog {
  entries: LogEntry[];
}
```

Update index.ts to include new exports:
```typescript
export * from './chat';
export * from './log';
```
  </action>
  <verify>TypeScript compiles: npm run typecheck passes</verify>
  <done>Chat and log types defined matching DAGENT_SPEC.md sections 4.5-4.6</done>
</task>

<task type="auto">
  <name>Task 3: Configure TypeScript paths and verify imports</name>
  <files>tsconfig.json, src/renderer/src/App.tsx</files>
  <action>
Update tsconfig.json (or tsconfig.web.json for renderer) to add path alias for shared types:
```json
{
  "compilerOptions": {
    "paths": {
      "@shared/*": ["./src/shared/*"]
    }
  }
}
```

Also update electron.vite.config.ts to resolve the alias for both main and renderer.

Test imports work by adding a simple import in App.tsx:
```typescript
import type { Feature, Task, DAGGraph } from '@shared/types';
// Add a comment showing types work
// TODO: Remove test import after verification
```

Verify both main process and renderer can import from @shared/types.
  </action>
  <verify>npm run typecheck passes, npm run dev starts without import errors</verify>
  <done>Path aliases configured, types importable from both main and renderer processes</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run typecheck` passes with no errors
- [ ] All 6 type files exist in src/shared/types/
- [ ] Types match DAGENT_SPEC.md sections 4.1-4.6 exactly
- [ ] @shared/types alias works in both main and renderer
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No TypeScript errors
- Types ready for use in storage layer (Plan 02-02)
</success_criteria>

<output>
After completion, create `.planning/phases/02-data-model/02-01-SUMMARY.md` with:
- List of type files created
- Any deviations from spec (if any)
- Path alias configuration details
- Ready for Plan 02-02
</output>
