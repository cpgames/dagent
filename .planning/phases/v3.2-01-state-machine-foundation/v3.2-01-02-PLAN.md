---
phase: v3.2-01-state-machine-foundation
plan: 02
type: execute
wave: 2
depends_on: ["v3.2-01-01"]
files_modified:
  - src/renderer/src/views/KanbanView.tsx
  - src/renderer/src/components/Kanban/KanbanColumn.tsx
  - src/renderer/src/components/Kanban/FeatureCard.tsx
  - src/main/dag-engine/task-pool.ts
  - src/main/dag-engine/orchestrator.ts
autonomous: true

must_haves:
  truths:
    - "TypeScript compilation passes with no errors"
    - "Kanban view handles all 9 feature states"
    - "Orchestrator respects new state machine"
  artifacts:
    - path: "src/renderer/src/views/KanbanView.tsx"
      provides: "Kanban column mapping for 9 states"
    - path: "src/main/dag-engine/orchestrator.ts"
      provides: "Execution orchestrator respecting new states"
  key_links:
    - from: "KanbanView.tsx"
      to: "FeatureStatus type"
      via: "status-to-column mapping"
    - from: "orchestrator.ts"
      to: "FeatureStatus type"
      via: "status checks for execution eligibility"
---

<objective>
Update UI components and orchestrator to handle the new 9-state feature lifecycle.

Purpose: Ensure all status-dependent code compiles and functions correctly with the new state machine.

Output: Type-safe codebase with all components updated for 9-state lifecycle.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/REQUIREMENTS.md

# Prior plan context (types were updated):
@.planning/phases/v3.2-01-state-machine-foundation/v3.2-01-01-SUMMARY.md

# Source files to modify:
@src/renderer/src/views/KanbanView.tsx
@src/renderer/src/components/Kanban/KanbanColumn.tsx
@src/renderer/src/components/Kanban/FeatureCard.tsx
@src/main/dag-engine/task-pool.ts
@src/main/dag-engine/orchestrator.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix all TypeScript compilation errors from status changes</name>
  <files>All files with type errors</files>
  <action>
    Run `npm run typecheck` to identify all files with type errors after the status type change.

    For each file with errors:
    1. If the file checks for 'backlog' status -> change to 'ready'
    2. If the file checks for 'needs_attention' status -> remove that check (status removed)
    3. If the file has switch/case on FeatureStatus -> add cases for new states (not_started, creating_worktree, investigating, questioning, ready)
    4. If the file uses status string literals -> update to match new type

    Common patterns to fix:
    - `status === 'backlog'` -> `status === 'ready'`
    - `status === 'needs_attention'` -> remove or handle gracefully
    - `case 'backlog':` -> `case 'ready':`
    - Status arrays like `['planning', 'backlog']` -> `['planning', 'ready']`

    DO NOT change any logic beyond what's required for type safety. The goal is compilation, not behavior changes.
  </action>
  <verify>npm run typecheck passes with no errors</verify>
  <done>All TypeScript files compile without errors</done>
</task>

<task type="auto">
  <name>Task 2: Update KanbanView column mapping for interim 4-column display</name>
  <files>src/renderer/src/views/KanbanView.tsx</files>
  <action>
    Update the status-to-column mapping function. Per requirements (KANBAN-03):
    - `not_started` -> Backlog column
    - `creating_worktree` -> In Progress column
    - `investigating` -> In Progress column
    - `questioning` -> In Progress column
    - `planning` -> In Progress column (was Planning column, now merged)
    - `ready` -> Backlog column (ready to start)
    - `in_progress` -> In Progress column
    - `completed` -> Completed column
    - `archived` -> Archived column

    NOTE: The full 4-column Kanban refactor is in Phase v3.2-04. For now, ensure the existing column structure works with the new statuses. If the current view has more than 4 columns (like Planning, Needs Attention), keep them temporarily but map new states appropriately.

    The key principle: any "active work" state (creating_worktree through in_progress) should show in In Progress. Features waiting to start (not_started, ready) go to Backlog.
  </action>
  <verify>Kanban view renders without errors for features in any of the 9 states</verify>
  <done>KanbanView maps all 9 states to appropriate columns</done>
</task>

<task type="auto">
  <name>Task 3: Update orchestrator execution eligibility checks</name>
  <files>src/main/dag-engine/orchestrator.ts</files>
  <action>
    Update the ExecutionOrchestrator to handle the new states:

    1. Find where it checks if a feature can be executed (likely checks for 'in_progress' or 'backlog' status)
    2. Update eligibility: features in 'in_progress' state can be executed
    3. Features in 'ready' state (not 'backlog') are candidates to start
    4. Features in 'creating_worktree', 'investigating', 'questioning', 'planning' states should NOT be executed (PM agent workflow in progress)
    5. Features in 'not_started' state should NOT be executed (need worktree first)

    Look for:
    - `feature.status === 'in_progress'` checks
    - `feature.status === 'backlog'` checks -> change to `feature.status === 'ready'`
    - Any status arrays or switch statements

    DO NOT change the execution loop logic beyond status checks. The orchestrator should continue to work the same way, just with updated status values.
  </action>
  <verify>Orchestrator compiles and respects new status values</verify>
  <done>Orchestrator correctly identifies executable features using new status values</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run typecheck` passes with zero errors
- [ ] `npm run build` completes successfully
- [ ] No runtime status-related crashes (strings compile-time checked)
</verification>

<success_criteria>
- All tasks completed
- Full TypeScript compilation passes
- Build completes without errors
- Codebase uses consistent 9-state terminology
</success_criteria>

<output>
After completion, create `.planning/phases/v3.2-01-state-machine-foundation/v3.2-01-02-SUMMARY.md`
</output>
