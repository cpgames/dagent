---
phase: 96-kanban-feature-card-updates
plan: 01
type: execute
wave: 2
depends_on: ["100-01", "95-01"]
files_modified:
  - src/renderer/src/components/Kanban/FeatureCard.tsx
  - src/renderer/src/components/Kanban/FeatureCard.css
autonomous: true

must_haves:
  truths:
    - "Archive button is removed from feature cards"
    - "Merge icon resembles Git branch merge"
    - "Start button only appears on Backlog features"
    - "Stop button only appears on In Progress features"
    - "Start button moves feature to In Progress and starts execution"
    - "Stop button stops execution and moves feature to Backlog"
  artifacts:
    - path: "src/renderer/src/components/Kanban/FeatureCard.tsx"
      provides: "Updated feature card with context-aware buttons"
      min_lines: 200
      contains: "status === 'backlog'"
    - path: "src/renderer/src/components/Kanban/FeatureCard.css"
      provides: "Updated styles for new merge icon"
      contains: "merge-btn"
  key_links:
    - from: "src/renderer/src/components/Kanban/FeatureCard.tsx"
      to: "onStart callback"
      via: "Start button in Backlog"
      pattern: "status === 'backlog'"
    - from: "src/renderer/src/components/Kanban/FeatureCard.tsx"
      to: "onStop callback"
      via: "Stop button in In Progress"
      pattern: "status === 'in_progress'"
---

<objective>
Update feature card actions and context-aware buttons.

Purpose: Remove manual archive button (auto-archive in Phase 99), improve merge icon clarity, and add context-aware Start/Stop buttons for workflow control.
Output: Updated FeatureCard component with conditional buttons based on feature status.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/milestones/v2.9-create-feature-workflow.md
@.planning/phases/100-feature-status-system/100-01-SUMMARY.md
@.planning/phases/95-kanban-column-restructure/95-01-SUMMARY.md
@src/renderer/src/components/Kanban/FeatureCard.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove Archive button and update Merge icon</name>
  <files>src/renderer/src/components/Kanban/FeatureCard.tsx</files>
  <action>
    **Remove Archive button**:
    - Locate the Archive button in feature card footer (lines 227-235)
    - Remove the entire Archive button JSX block
    - Remove handleArchive callback
    - Remove onArchive prop from FeatureCardProps interface (line 10)
    - Archive will be automatic in Phase 99, so manual button not needed

    **Update Merge icon** (MergeIcon component, lines 83-94):
    - Replace current icon SVG with a Git branch merge icon
    - Use two branches joining into one path
    - Example SVG path (branching Y-shape):
      ```svg
      <svg className="feature-card__icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <circle cx="5" cy="6" r="3" strokeWidth="2" />
        <circle cx="19" cy="18" r="3" strokeWidth="2" />
        <circle cx="5" cy="18" r="3" strokeWidth="2" />
        <path d="M5 9v6" strokeWidth="2" strokeLinecap="round" />
        <path d="M19 15c0-3.314-2.686-6-6-6H5" strokeWidth="2" strokeLinecap="round" />
      </svg>
      ```
    - This creates a clear branch merge visualization (two branches merging into one)

    Why: Archive is automatic now, merge icon should be instantly recognizable as Git merge.
    Avoid: Do not change merge button functionality (just the icon).
  </action>
  <verify>npm run build succeeds</verify>
  <done>Archive button removed, merge icon is Git branch merge visual</done>
</task>

<task type="auto">
  <name>Task 2: Implement context-aware Start button (Backlog only)</name>
  <files>src/renderer/src/components/Kanban/FeatureCard.tsx, src/renderer/src/components/Kanban/FeatureCard.css</files>
  <action>
    **Update button visibility logic**:
    - Remove existing canStart logic (line 102: `canStart = not_started || needs_attention`)
    - Replace with: `const showStart = feature.status === 'backlog'`
    - Only show Start button when feature is in Backlog column

    **Update Start button behavior**:
    - When clicked, Start button should:
      1. Call updateFeatureStatus(featureId, 'in_progress') to move to In Progress
      2. Call onStart(featureId) to start execution (existing behavior)
    - These happen sequentially (status first, then start execution)
    - Handle errors gracefully (show toast if status update fails)

    **Update rendering** (lines 166-177):
    - Change condition from `canStart` to `showStart`
    - Keep existing PlayIcon and SpinnerIcon components
    - Keep existing loading state handling

    **Props**:
    - onStart prop should remain in FeatureCardProps
    - This will be connected to orchestrator start in parent component

    Why: Start button only makes sense on Backlog features (ready to begin work).
    Avoid: Do not remove Start button entirely - it's still needed for Backlog.
  </action>
  <verify>npm run build succeeds</verify>
  <done>Start button only appears on features with status === 'backlog'</done>
</task>

<task type="auto">
  <name>Task 3: Implement context-aware Stop button (In Progress only)</name>
  <files>src/renderer/src/components/Kanban/FeatureCard.tsx</files>
  <action>
    **Add Stop button logic**:
    - Add StopIcon SVG component (square icon):
      ```jsx
      function StopIcon(): React.JSX.Element {
        return (
          <svg className="feature-card__icon" fill="currentColor" viewBox="0 0 24 24">
            <rect x="6" y="6" width="12" height="12" />
          </svg>
        );
      }
      ```
    - Add showStop condition: `const showStop = feature.status === 'in_progress'`

    **Add onStop prop**:
    - Add onStop?: (featureId: string) => void to FeatureCardProps interface
    - Add onStop to component props destructuring

    **Stop button behavior**:
    - When clicked:
      1. Call onStop(featureId) to stop orchestrator/execution
      2. Call updateFeatureStatus(featureId, 'backlog') to move back to Backlog
    - Handle errors gracefully

    **Add Stop button rendering**:
    - Add in actions section (next to Start button logic)
    - Only render when showStop is true
    - Similar structure to Start button:
      ```jsx
      {showStop && onStop && (
        <button
          className="feature-card__action-btn feature-card__action-btn--stop"
          onClick={handleStop}
          aria-label={`Stop ${feature.name}`}
          title="Stop execution"
        >
          <StopIcon />
        </button>
      )}
      ```

    **Update parent component** (KanbanView.tsx):
    - Add handleStopFeature callback
    - Call execution store's stop method
    - Call updateFeatureStatus(featureId, 'backlog')
    - Pass handleStopFeature to FeatureCard as onStop prop

    Why: Stop button provides workflow control for running features.
    Avoid: Do not add Stop button to other statuses - only In Progress.
  </action>
  <verify>npm run build succeeds</verify>
  <done>Stop button only appears on features with status === 'in_progress', moves back to Backlog</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] npm run build succeeds with no TypeScript errors
- [ ] Archive button is removed from feature cards
- [ ] Merge icon is a Git branch merge visual
- [ ] Start button only appears on Backlog features
- [ ] Stop button only appears on In Progress features
- [ ] Start button moves to In Progress and starts execution
- [ ] Stop button stops execution and moves to Backlog
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No errors or warnings introduced
- Feature cards have context-appropriate actions based on status
</success_criteria>

<output>
After completion, create `.planning/phases/96-kanban-feature-card-updates/96-01-SUMMARY.md`
</output>
