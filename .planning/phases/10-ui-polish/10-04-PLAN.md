---
phase: 10-ui-polish
plan: 04
type: execute
---

<objective>
Fix layout issues and clean up placeholder content for a polished user experience.

Purpose: Remove rough edges that create a janky experience - fix textarea sizing, clarify disabled buttons, show real data.
Output: ContextView textarea fills screen, disabled buttons explain why, FeatureCard shows real task counts.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./10-04-SUMMARY.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

**Prior plan:**
@.planning/phases/10-ui-polish/10-03-PLAN.md

**Key files:**
@src/renderer/src/views/ContextView.tsx
@src/renderer/src/components/Feature/FeatureCard.tsx
@src/renderer/src/components/Feature/FeatureChat.tsx
@src/renderer/src/components/DAG/NodeDialog.tsx
@src/renderer/src/App.tsx

**Issues to fix:**
1. ContextView textarea may not expand to fill available screen space
2. Disabled buttons show no explanation ("Generate with AI", "Re-evaluate deps", Chat button)
3. Hardcoded "0 tasks" placeholder in FeatureCard
4. Various placeholder comments need cleanup

**Current disabled buttons:**
- Generate with AI: title="Generate with AI (coming in Phase 7)"
- Re-evaluate deps: title="AI will analyze the graph and suggest dependency changes (coming soon)"
- Chat button in NodeDialog: title="Chat (coming in Phase 7)"
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix ContextView textarea to fill available screen space</name>
  <files>src/renderer/src/views/ContextView.tsx</files>
  <action>
Ensure the ContextView layout properly fills available space:

1. Verify the main container uses flex-1 and flex-col:
```tsx
<div className="flex-1 flex flex-col min-h-0 p-4">
```

2. The content area should expand:
```tsx
<div className="flex-1 min-h-0 flex flex-col">
  {/* Error display if any */}
  <textarea
    className="flex-1 w-full p-3 bg-neutral-800 border border-neutral-600 rounded-lg text-sm font-mono resize-none focus:outline-none focus:border-blue-500 min-h-0"
    ...
  />
</div>
```

Key CSS properties:
- Container: `flex-1 flex flex-col min-h-0`
- Textarea: `flex-1 min-h-0 resize-none`

The min-h-0 is critical for flex children to shrink below their content size.
  </action>
  <verification>
- Textarea fills the available vertical space
- Textarea doesn't overflow or get cut off
- Content scrolls within the textarea when it exceeds visible area
  </verification>
</task>

<task type="auto">
  <name>Task 2: Improve disabled button affordance in ContextView</name>
  <files>src/renderer/src/views/ContextView.tsx</files>
  <action>
Update the "Generate with AI" button to clearly indicate it's not yet available:

1. Add visual distinction for "coming soon" state:
```tsx
<button
  className="px-3 py-1.5 rounded text-sm bg-neutral-700 text-neutral-400 cursor-not-allowed opacity-60"
  disabled
  title="Coming soon: AI will generate context from your codebase"
>
  <span className="flex items-center gap-1">
    Generate with AI
    <span className="text-xs">(Soon)</span>
  </span>
</button>
```

2. Make the button look clearly disabled with opacity and cursor-not-allowed.

3. Update tooltip to be more informative about what it will do.
  </action>
  <verification>
- Button appears visually disabled (grayed out)
- Tooltip explains the feature
- "(Soon)" label makes status clear
  </verification>
</task>

<task type="auto">
  <name>Task 3: Improve disabled button affordance in FeatureChat</name>
  <files>src/renderer/src/components/Feature/FeatureChat.tsx</files>
  <action>
Update the "Re-evaluate deps" button:

```tsx
<button
  className="px-2 py-1 text-xs rounded bg-neutral-700 text-neutral-400 cursor-not-allowed opacity-60"
  disabled
  title="Coming soon: AI will analyze your graph and suggest dependency changes"
>
  <span className="flex items-center gap-1">
    Re-evaluate deps
    <span className="text-[10px]">(Soon)</span>
  </span>
</button>
```

Make it clearly disabled with visual styling that matches the ContextView pattern.
  </action>
  <verification>
- Button appears visually disabled
- Tooltip explains the feature
- Consistent with other "coming soon" buttons
  </verification>
</task>

<task type="auto">
  <name>Task 4: Improve disabled Chat button in NodeDialog</name>
  <files>src/renderer/src/components/DAG/NodeDialog.tsx</files>
  <action>
Update the Chat button in NodeDialog footer:

```tsx
<button
  className="px-3 py-1.5 rounded text-sm bg-neutral-700 text-neutral-400 cursor-not-allowed opacity-60"
  disabled
  title="Coming soon: Chat with AI about this task"
>
  <span className="flex items-center gap-1">
    Chat
    <span className="text-xs">(Soon)</span>
  </span>
</button>
```

Ensure visual consistency with other disabled "coming soon" buttons.
  </action>
  <verification>
- Button appears visually disabled
- Tooltip explains the feature
- Consistent with other disabled buttons
  </verification>
</task>

<task type="auto">
  <name>Task 5: Show real task count in FeatureCard</name>
  <files>src/renderer/src/components/Feature/FeatureCard.tsx, src/renderer/src/stores/dag-store.ts</files>
  <action>
Replace the hardcoded "0 tasks" with actual task count from the DAG.

Option 1 (Simple - from feature prop if available):
If Feature type has tasks array, use it:
```tsx
<span className="text-xs text-neutral-400">
  {feature.tasks?.length ?? 0} tasks
</span>
```

Option 2 (If tasks need to be loaded from DAG):
The FeatureCard would need access to the DAG store. However, loading DAG for each card may be expensive.

Recommended approach - add taskCount to Feature type or compute from loaded data:

1. First check if Feature type includes task count
2. If not, for MVP just show "- tasks" or remove the placeholder entirely:
```tsx
{/* Task count - requires DAG load, omitted for performance */}
```

Or show tasks only when DAG is loaded for the selected feature:
```tsx
<span className="text-xs text-neutral-400">
  {isSelected ? `${taskCount} tasks` : ''}
</span>
```

Choose the simplest approach that doesn't require loading DAGs for all features.
  </action>
  <verification>
- No hardcoded "0 tasks" placeholder
- Either shows real count or is removed
- Doesn't cause performance issues
  </verification>
</task>

<task type="auto">
  <name>Task 6: Final cleanup - remove outdated TODO comments</name>
  <files>src/renderer/src/views/ContextView.tsx</files>
  <action>
Review and update TODO comments in ContextView:

1. The `handleSave` TODO about implementing actual save - keep as it's still a TODO
2. The `handleGenerate` TODO - update comment to clarify it's a Phase 7+ feature
3. Any console.log statements used for debugging - keep for now but add TODO comment

Update the generate function comment:
```typescript
// TODO (Phase 7+): Implement AI context generation
const handleGenerate = async () => {
  // ...
}
```

Update save function comment:
```typescript
// TODO: Implement actual save via IPC to write CLAUDE.md file
const handleSave = async () => {
  // ...
}
```
  </action>
  <verification>
- TODO comments are accurate and helpful
- No outdated phase references
- Code is ready for future implementation
  </verification>
</task>

</tasks>
