---
phase: 06-ui-views
plan: 04
type: execute
---

<objective>
Implement Node Dialog for task editing and Context View for CLAUDE.md management.

Purpose: Enable task detail editing and project context configuration.
Output: Working Node Dialog modal and Context View per DAGENT_SPEC 3.3 and 3.5.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-phase.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/06-ui-views/06-01-SUMMARY.md
@.planning/phases/06-ui-views/06-03-SUMMARY.md
@src/renderer/src/stores/dag-store.ts
@src/shared/types/index.ts

**Tech stack available:** React, TypeScript, Tailwind CSS, Zustand
**Established patterns:**
- useDAGStore for dag state and updateNode action
- Task type with title, description, status, locked

**From DAGENT_SPEC 3.3 (Node Dialog):**
- Name field (editable)
- Description field (multiline, editable)
- Status display (read-only)
- Lock toggle button
- Chat button (opens Node Chat - implement in Phase 7)
- Save/Cancel buttons

**From DAGENT_SPEC 3.5 (Context View):**
- Large textarea for CLAUDE.md content
- "Generate with AI" button (placeholder - AI integration in Phase 7)
- "Save to CLAUDE.md" button
- Last synced timestamp
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create dialog store for modal state</name>
  <files>src/renderer/src/stores/dialog-store.ts, src/renderer/src/stores/index.ts</files>
  <action>
Create Zustand store for managing dialog/modal state:

```tsx
interface DialogState {
  // Node dialog
  nodeDialogOpen: boolean;
  nodeDialogTaskId: string | null;

  // Actions
  openNodeDialog: (taskId: string) => void;
  closeNodeDialog: () => void;
}
```

This centralizes dialog state so TaskNode can open dialogs and App can render them.
Update stores/index.ts to export useDialogStore.
  </action>
  <verify>npm run typecheck passes</verify>
  <done>Dialog store manages nodeDialogOpen and nodeDialogTaskId state</done>
</task>

<task type="auto">
  <name>Task 2: Create NodeDialog component</name>
  <files>src/renderer/src/components/DAG/NodeDialog.tsx</files>
  <action>
Create NodeDialog modal component per DAGENT_SPEC 3.3:

```tsx
interface NodeDialogProps {
  task: Task;
  onSave: (updates: Partial<Task>) => void;
  onClose: () => void;
}
```

Structure:
1. Modal overlay (fixed inset-0 bg-black/50)
2. Modal content (centered card with max-w-lg)
3. Header with task title and close button
4. Form fields:
   - Name input (controlled, text input)
   - Description textarea (controlled, 4 rows)
   - Status badge (read-only, colored)
   - Lock toggle button (icon changes based on locked state)
   - Chat button (placeholder, disabled for now)
5. Footer with Save/Cancel buttons

Styling:
- bg-gray-800 rounded-lg shadow-xl
- Inputs: bg-gray-700 border-gray-600 focus:ring-blue-500
- Status badge uses status colors
- Lock button: ðŸ”’ locked, ðŸ”“ unlocked

Handle form state locally, call onSave with changes on submit.
  </action>
  <verify>npm run typecheck passes</verify>
  <done>NodeDialog modal with editable name, description, lock toggle</done>
</task>

<task type="auto">
  <name>Task 3: Implement Context View</name>
  <files>src/renderer/src/views/ContextView.tsx</files>
  <action>
Replace placeholder with Context View implementation per DAGENT_SPEC 3.5:

1. Create local state for context content and lastSynced timestamp
2. Load CLAUDE.md content on mount via IPC (if exists)
3. Large textarea for editing content
4. "Generate with AI" button (disabled placeholder)
5. "Save to CLAUDE.md" button that writes via IPC

Structure:
```tsx
export default function ContextView() {
  const [content, setContent] = useState('');
  const [lastSynced, setLastSynced] = useState<string | null>(null);
  const [isSaving, setIsSaving] = useState(false);

  // Load CLAUDE.md on mount
  useEffect(() => {
    // window.electronAPI.storage.loadClaudeMd() - add this IPC method
  }, []);

  const handleSave = async () => {
    // window.electronAPI.storage.saveClaudeMd(content)
    setLastSynced(new Date().toISOString());
  };
  // ...
}
```

Layout:
- Header: "Project Context" title + "Generate with AI" button (right)
- Main: Full-width textarea with markdown styling (font-mono)
- Footer: "Save to CLAUDE.md" button + last synced timestamp

Note: IPC methods for CLAUDE.md don't exist yet. Create stubs that show "Not implemented" toast or just log to console. Actual storage integration will be Phase 7.
  </action>
  <verify>npm run dev shows Context view with textarea and buttons</verify>
  <done>Context View has textarea, save button, and generate placeholder</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run typecheck` passes
- [ ] NodeDialog opens when clicking task node edit button
- [ ] NodeDialog shows task name, description, status
- [ ] Lock toggle works in NodeDialog
- [ ] Save button updates task in store
- [ ] Context View shows large textarea
- [ ] Save to CLAUDE.md button visible (implementation deferred)
</verification>

<success_criteria>
- Dialog store for modal state management
- NodeDialog component with form fields
- Context View with textarea and buttons
- Dialogs integrate with DAG view
</success_criteria>

<output>
After completion, create `.planning/phases/06-ui-views/06-04-SUMMARY.md`
</output>
