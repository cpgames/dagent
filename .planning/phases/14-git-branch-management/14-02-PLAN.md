---
phase: 14-git-branch-management
plan: 02
type: execute
---

<objective>
Add branch switcher UI with dropdown in status bar for viewing and switching branches.

Purpose: Enable users to switch branches directly from the UI without using terminal.
Output: BranchSwitcher dropdown component with branch list and switch functionality.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-phase.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

**Prior Plan:**
14-01-SUMMARY.md (git status monitoring)

**Existing Files:**
@src/main/git/git-manager.ts
@src/renderer/src/stores/git-store.ts
@src/renderer/src/components/Git/GitStatus.tsx
@src/preload/index.d.ts
@src/preload/index.ts

**Tech stack available:** electron-vite, Tailwind v4, Zustand, simple-git
**Established patterns:** IPC handler pattern, dialog pattern (see AuthDialog, NewFeatureDialog)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add checkout IPC handler</name>
  <files>src/main/ipc/git-handlers.ts, src/preload/index.ts, src/preload/index.d.ts</files>
  <action>
    Add new IPC handler for branch checkout:
    1. In git-handlers.ts, add handler 'git:checkout' that:
       - Takes branchName: string parameter
       - Calls gitManager.getGit().checkout(branchName)
       - Returns GitOperationResult

    2. In preload index.ts, add to git object:
       checkout: (branchName: string) => ipcRenderer.invoke('git:checkout', branchName)

    3. In preload index.d.ts, add to GitAPI:
       checkout: (branchName: string) => Promise<GitOperationResult>

    Note: GitManager already has listBranches() exposed, just need checkout.
  </action>
  <verify>npm run typecheck passes</verify>
  <done>git:checkout IPC handler exists and is accessible via electronAPI.git.checkout()</done>
</task>

<task type="auto">
  <name>Task 2: Create BranchSwitcher dropdown component</name>
  <files>src/renderer/src/components/Git/BranchSwitcher.tsx, src/renderer/src/components/Git/index.ts</files>
  <action>
    Create BranchSwitcher component as a dropdown:
    1. When clicked, show a dropdown menu positioned above the status bar
    2. Dropdown shows list of all local branches from git-store
    3. Current branch highlighted with checkmark or different styling
    4. Clicking a branch calls checkout and refreshes status
    5. Show loading state during checkout
    6. Show error toast if checkout fails

    Load branches when dropdown opens (call listBranches).
    Add to git-store:
    - branches: BranchInfo[]
    - loadBranches: () => Promise<void>
    - checkoutBranch: (name: string) => Promise<boolean>

    Style: Dark dropdown matching app theme, max-height with scroll if many branches.
    Close dropdown on outside click or Escape key.
  </action>
  <verify>npm run typecheck passes</verify>
  <done>BranchSwitcher dropdown shows branches and allows switching</done>
</task>

<task type="auto">
  <name>Task 3: Integrate BranchSwitcher into GitStatus</name>
  <files>src/renderer/src/components/Git/GitStatus.tsx</files>
  <action>
    Update GitStatus to use BranchSwitcher:
    1. Replace the placeholder onClick with toggle for BranchSwitcher dropdown
    2. Wrap GitStatus button + BranchSwitcher in a relative positioned container
    3. BranchSwitcher dropdown positioned absolutely above the button
    4. Add isOpen state to control dropdown visibility
    5. After successful checkout, reload git status

    The flow: Click branch name → dropdown opens → select branch → checkout → dropdown closes → status updates.
  </action>
  <verify>npm run typecheck passes</verify>
  <done>Clicking branch name opens dropdown, branch selection works</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run typecheck` succeeds without errors
- [ ] Clicking branch in status bar opens dropdown
- [ ] Dropdown shows all local branches
- [ ] Selecting a branch switches to it
- [ ] Status updates after branch switch
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Branch switching works end-to-end
- No TypeScript errors introduced
- Phase 14 complete
</success_criteria>

<output>
After completion, create `.planning/phases/14-git-branch-management/14-02-SUMMARY.md`
</output>
