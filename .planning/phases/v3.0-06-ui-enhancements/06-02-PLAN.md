---
phase: v3.0-06-ui-enhancements
plan: 02
type: execute
wave: 2
depends_on: [06-01]
files_modified:
  - src/renderer/src/components/Chat/SessionActions.tsx
  - src/renderer/src/components/Chat/SessionActions.css
  - src/renderer/src/components/Chat/index.ts
autonomous: true
must_haves:
  truths:
    - "User can clear messages while keeping checkpoint"
    - "User can force compaction manually"
    - "User can reset entire session (clear all data)"
    - "User can export session as JSON file"
    - "Actions show confirmation dialogs for destructive operations"
  artifacts:
    - path: "src/renderer/src/components/Chat/SessionActions.tsx"
      provides: "Dropdown menu with session management actions"
      exports: ["SessionActions"]
  key_links:
    - from: "SessionActions.tsx"
      to: "session API"
      via: "window.api.session.clearMessages, forceCompact"
      pattern: "clearMessages|forceCompact"
---

<objective>
Create session actions menu component for the chat panel.

Purpose: Give users control over session lifecycle - clearing messages, forcing compaction, resetting sessions, and exporting data.
Output: React dropdown menu component with session management actions.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/milestones/v3.0-session-checkpoint-ROADMAP.md
@.planning/phases/v3.0-06-ui-enhancements/06-01-PLAN.md

@src/renderer/src/components/Chat/ChatPanel.tsx
@src/renderer/src/components/Chat/ChatPanel.css
@src/renderer/src/components/UI/index.ts
@src/preload/index.d.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SessionActions component</name>
  <files>src/renderer/src/components/Chat/SessionActions.tsx, src/renderer/src/components/Chat/SessionActions.css</files>
  <action>
    Create a dropdown menu component with session management actions:

    1. **Clear Messages** - Clears chat messages but keeps checkpoint intact
    2. **Force Compaction** - Triggers manual compaction (useful before long tasks)
    3. **Reset Session** - Clears everything including checkpoint (destructive)
    4. **Export Session** - Downloads session as JSON file

    Component structure:
    ```typescript
    interface SessionActionsProps {
      sessionId: string | null
      featureId: string
      projectRoot: string
      disabled?: boolean
    }

    export function SessionActions({ sessionId, featureId, projectRoot, disabled }: SessionActionsProps): JSX.Element
    ```

    Implementation details:
    - Use a dropdown menu triggered by a "..." or gear icon button
    - Menu items with icons for each action
    - Confirmation dialogs for destructive actions (Reset Session)
    - Loading states during async operations
    - Disabled state when no session exists
    - Toast/notification feedback on success/error

    Actions implementation:
    - Clear Messages: `window.api.session.clearMessages(featureId, projectRoot)`
    - Force Compaction: `window.api.session.forceCompact(featureId, projectRoot)`
    - Reset Session: Clear messages then delete session file (or dedicated reset method)
    - Export Session: Get full session data and trigger browser download

    Visual design:
    - Small icon button (gear or three dots) that opens dropdown
    - Dropdown positioned below/left of trigger button
    - Icons for each menu item matching action semantics
    - Destructive actions (Reset) shown in red/warning color
    - Hover states on menu items
    - Click outside to close dropdown

    Confirmation dialog for Reset:
    - Modal overlay with warning message
    - "This will permanently delete all session data including checkpoint"
    - Cancel and Confirm buttons
    - Confirm button in red/warning style

    CSS classes: session-actions, session-actions__trigger, session-actions__menu,
                 session-actions__item, session-actions__item--danger, session-actions__confirm-dialog
  </action>
  <verify>npm run build succeeds, component exports correctly</verify>
  <done>SessionActions dropdown with Clear Messages, Force Compaction, Reset Session, Export Session actions</done>
</task>

<task type="auto">
  <name>Task 2: Update Chat barrel file exports</name>
  <files>src/renderer/src/components/Chat/index.ts</files>
  <action>
    Add export for SessionActions to the Chat components barrel file:

    ```typescript
    export { SessionActions } from './SessionActions'
    ```

    This should be added after the exports from Plan 06-01 (SessionStatus, CheckpointViewer).
  </action>
  <verify>npm run build succeeds, export resolves correctly</verify>
  <done>SessionActions exported from Chat barrel file</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] SessionActions.tsx created with dropdown menu
- [ ] Clear Messages action works (calls clearMessages API)
- [ ] Force Compaction action works (calls forceCompact API)
- [ ] Reset Session shows confirmation dialog before executing
- [ ] Export Session downloads JSON file
- [ ] Component handles disabled/no-session state gracefully
- [ ] Dropdown closes on click outside
- [ ] Component exported from Chat barrel file
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No TypeScript errors
- Component follows existing Chat panel styling patterns
- Destructive actions require confirmation
</success_criteria>

<output>
After completion, create `.planning/phases/v3.0-06-ui-enhancements/06-02-SUMMARY.md`
</output>
