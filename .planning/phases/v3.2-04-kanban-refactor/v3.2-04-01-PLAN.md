---
phase: v3.2-04-kanban-refactor
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/renderer/src/views/KanbanView.tsx
  - src/renderer/src/components/Kanban/KanbanColumn.tsx
  - src/renderer/src/components/Kanban/KanbanColumn.css
autonomous: true

must_haves:
  truths:
    - "Kanban displays exactly 4 columns: Backlog, In Progress, Completed, Archived"
    - "Features with status 'not_started' appear in Backlog column"
    - "Features with status 'completed' appear in Completed column"
    - "Features with status 'archived' appear in Archived column"
    - "All other feature statuses appear in In Progress column"
    - "Feature cards move between columns when status changes (no manual refresh)"
  artifacts:
    - path: "src/renderer/src/views/KanbanView.tsx"
      provides: "Column-to-status mapping function"
      contains: "getColumnForStatus"
    - path: "src/renderer/src/components/Kanban/KanbanColumn.css"
      provides: "Column header styling for 4 columns only"
  key_links:
    - from: "KanbanView.tsx"
      to: "feature-store subscribeToFeatureStatusChanges"
      via: "main.tsx initialization"
      pattern: "subscribeToFeatureStatusChanges"
---

<objective>
Align Kanban implementation with Phase v3.2-04 requirements.

Purpose: Ensure Kanban column mapping matches the spec exactly (not_started → Backlog, completed → Completed, archived → Archived, all other states → In Progress).

Output: Clean 4-column Kanban with correct status-to-column mapping and cleaned up CSS.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@src/renderer/src/views/KanbanView.tsx
@src/renderer/src/components/Kanban/KanbanColumn.tsx
@src/renderer/src/components/Kanban/KanbanColumn.css
@src/renderer/src/components/Kanban/FeatureCard.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update column-to-status mapping in KanbanView</name>
  <files>src/renderer/src/views/KanbanView.tsx</files>
  <action>
Update the `columns` array to match the exact requirements:

**Current (incorrect):**
```typescript
const columns = [
  { title: 'Backlog', statuses: ['not_started', 'ready'] },
  { title: 'In Progress', statuses: ['creating_worktree', 'investigating', 'questioning', 'planning', 'in_progress'] },
  ...
];
```

**Required (per KANBAN-03):**
```typescript
const columns: { title: string; statuses: FeatureStatus[] }[] = [
  { title: 'Backlog', statuses: ['not_started'] },
  { title: 'In Progress', statuses: ['creating_worktree', 'investigating', 'questioning', 'planning', 'ready', 'in_progress'] },
  { title: 'Completed', statuses: ['completed'] },
  { title: 'Archived', statuses: ['archived'] },
];
```

The key change: Move `ready` from Backlog to In Progress. Per the spec:
- Only `not_started` maps to Backlog
- All other non-terminal states map to In Progress

Also update the JSDoc comment above `columns` to accurately reflect the new mapping:
```typescript
/**
 * Column configuration for the Kanban board.
 * 4-column layout mapping 9 states:
 * - Backlog: not_started (feature exists but no worktree)
 * - In Progress: creating_worktree, investigating, questioning, planning, ready, in_progress
 * - Completed: completed
 * - Archived: archived
 */
```

Reason for change: The requirement KANBAN-03 explicitly states "not_started → Backlog" and "all other states → In Progress". The `ready` status means tasks are created and the feature is ready to execute - this is active work, not backlog.
  </action>
  <verify>npm run typecheck passes</verify>
  <done>Column mapping follows spec exactly: only not_started in Backlog</done>
</task>

<task type="auto">
  <name>Task 2: Simplify KanbanColumn status prop usage</name>
  <files>src/renderer/src/components/Kanban/KanbanColumn.tsx</files>
  <action>
The `status` prop is currently used for CSS class on the title. Since columns now represent logical groupings (not single statuses), update the logic:

1. Change the title class to use a simple column identifier instead of status:
   - Map column titles to CSS class suffixes: 'Backlog' → 'backlog', 'In Progress' → 'in-progress', etc.
   - Create a helper: `const titleClass = title.toLowerCase().replace(/\s+/g, '-');`

2. Update the title element:
   ```tsx
   <h3 className={`kanban-column__title kanban-column__title--${titleClass}`}>
   ```

This removes the awkward dependency on passing the "first status" to color the column header.

Note: The `status` prop may still be needed for other purposes - keep it but don't use it for title styling.
  </action>
  <verify>npm run typecheck passes</verify>
  <done>Column title styling uses column name, not arbitrary first status</done>
</task>

<task type="auto">
  <name>Task 3: Clean up KanbanColumn.css</name>
  <files>src/renderer/src/components/Kanban/KanbanColumn.css</files>
  <action>
Update the CSS to match the new 4-column structure:

1. Remove obsolete status-specific title classes:
   - Remove `.kanban-column__title--planning` (planning is now in In Progress)
   - Remove `.kanban-column__title--needs_attention` (status removed in v3.2-01)

2. Update title classes to use column names:
   ```css
   /* Column-specific title colors */
   .kanban-column__title--backlog {
     color: var(--text-secondary);
   }

   .kanban-column__title--in-progress {
     color: var(--color-warning);
   }

   .kanban-column__title--completed {
     color: var(--color-success);
   }

   .kanban-column__title--archived {
     color: var(--text-muted);
   }
   ```

3. Remove any other status-specific classes that are no longer used.

This simplifies the CSS and aligns with the 4-column model.
  </action>
  <verify>npm run build succeeds</verify>
  <done>CSS cleaned up with only 4 column-specific classes</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run typecheck` passes
- [ ] `npm run build` succeeds
- [ ] Column mapping: not_started only in Backlog
- [ ] Column mapping: ready is in In Progress (not Backlog)
- [ ] CSS has exactly 4 column title classes (backlog, in-progress, completed, archived)
- [ ] No TypeScript errors related to status types
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Kanban displays 4 columns with correct status mapping
- CSS is clean with no obsolete status classes
</success_criteria>

<output>
After completion, create `.planning/phases/v3.2-04-kanban-refactor/v3.2-04-01-SUMMARY.md`
</output>
