# Phase 26: Agent Logs View - Plan 26-01

## Overview

Add an AgentLogsPanel component to display agent communication during task execution. The panel will show log entries with timestamps, agent names, and content. Users can filter by agent type and logs auto-scroll during active execution.

## Analysis

### Existing Infrastructure

- **LogEntry type** (`src/shared/types/log.ts`): `timestamp`, `type`, `agent`, `taskId?`, `content`
- **AgentLog type**: Container with `entries: LogEntry[]`
- **LogEntryType**: 'intention' | 'approval' | 'rejection' | 'modification' | 'action' | 'error'
- **AgentType**: 'harness' | 'task' | 'merge'
- **Storage**: `loadHarnessLog(featureId)`, `loadNodeLogs(featureId, nodeId)` already in IPC
- **AgentsView**: Existing view showing agent configuration and status

### Design Decision

Add AgentLogsPanel as a tab within AgentsView rather than a new view type. This keeps agent-related information together and avoids view proliferation. The AgentsView will have two tabs: "Configuration" (current content) and "Logs".

## Tasks

### Task 1: Create AgentLogsPanel Component

Create `src/renderer/src/components/Agents/AgentLogsPanel.tsx`:

**File operations:**
- Create `AgentLogsPanel.tsx` with:
  - Props: `featureId: string | null`
  - State: `filter: AgentType | 'all'`, `entries: LogEntry[]`, `isLoading: boolean`
  - Load logs via `window.electronAPI.storage.loadHarnessLog(featureId)`
  - Filter controls: dropdown/tabs for harness | task | merge | all
  - Log entry rendering with timestamp, agent badge, type badge, content
  - Auto-scroll ref with `scrollIntoView` when new entries arrive
- Export from `src/renderer/src/components/Agents/index.ts`

**Styling:**
- Agent badges: harness=purple, task=blue, merge=green
- Type badges: intention=gray, approval=green, rejection=red, action=blue, error=red
- Timestamp: gray, small, monospace

**Commit:** `feat(26-01): create AgentLogsPanel component with filtering`

### Task 2: Add Logs Tab to AgentsView

Modify `src/renderer/src/views/AgentsView.tsx`:

**File operations:**
- Add local state: `activeTab: 'config' | 'logs'`
- Add tab buttons below header (before grid)
- Conditionally render grid/config panel OR AgentLogsPanel based on tab
- Pass `activeFeatureId` from feature-store to AgentLogsPanel
- Import AgentLogsPanel

**Commit:** `feat(26-01): add logs tab to AgentsView`

### Task 3: Add Polling for Live Updates

Update AgentLogsPanel to poll for new entries during execution:

**File operations:**
- Add useEffect with interval (2s) to reload logs when execution is active
- Check execution state via `useExecutionStore` for `isRunning` status
- Clear interval on unmount or when execution stops
- Merge new entries with existing (dedupe by timestamp + content hash or just replace)

**Commit:** `feat(26-01): add log polling during active execution`

## Verification

After implementation:
1. Open Agents view and switch to Logs tab
2. Verify logs load for current feature (or show "No feature selected")
3. Filter by agent type and verify filtering works
4. Verify auto-scroll to bottom on new entries
5. Verify log entries show timestamp, agent, type, and content
6. Build passes: `npm run build`

## Summary

| Task | File(s) | Description |
|------|---------|-------------|
| 1 | AgentLogsPanel.tsx, Agents/index.ts | Create component with filter and auto-scroll |
| 2 | AgentsView.tsx | Add config/logs tabs |
| 3 | AgentLogsPanel.tsx | Add polling for live updates |
