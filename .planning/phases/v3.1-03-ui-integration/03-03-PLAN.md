---
phase: v3.1-03-ui-integration
plan: 03
type: execute
wave: 2
depends_on: ["03-01"]
files_modified: [src/renderer/src/components/DAG/TaskNode.tsx, src/renderer/src/components/DAG/TaskNode.css]
autonomous: true

must_haves:
  truths:
    - "needs_analysis tasks show distinct purple/violet color"
    - "needs_analysis tasks show analysis icon"
    - "Tasks being analyzed show pulsing animation"
  artifacts:
    - path: "src/renderer/src/components/DAG/TaskNode.tsx"
      provides: "Analysis state visualization"
      contains: "needs_analysis"
    - path: "src/renderer/src/components/DAG/TaskNode.css"
      provides: "Analysis animation and colors"
      contains: "analyzing"
  key_links:
    - from: "src/renderer/src/components/DAG/TaskNode.tsx"
      to: "TaskNodeData"
      via: "isBeingAnalyzed prop"
      pattern: "isBeingAnalyzed"
---

<objective>
Update TaskNode component for analysis state visualization.

Purpose: Provide clear visual feedback for tasks in analysis state
Output: TaskNode shows analysis icon and animation for needs_analysis tasks
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/v3.1-03-ui-integration/03-01-SUMMARY.md

@src/renderer/src/components/DAG/TaskNode.tsx
@src/renderer/src/components/DAG/TaskNode.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add analysis icon to TaskNode</name>
  <files>src/renderer/src/components/DAG/TaskNode.tsx</files>
  <action>
    Add analysis visualization:
    1. Add `isBeingAnalyzed?: boolean` to TaskNodeData interface
    2. Add magnifying glass icon SVG for needs_analysis status (show in badge section)
    3. Apply pulsing CSS class when `isBeingAnalyzed` is true
    4. Update badge tooltip to show "This task needs complexity analysis"
    5. Keep existing NEEDS ANALYSIS badge text
  </action>
  <verify>TypeScript compiles</verify>
  <done>TaskNode shows analysis icon for needs_analysis tasks</done>
</task>

<task type="auto">
  <name>Task 2: Add analysis animations to TaskNode CSS</name>
  <files>src/renderer/src/components/DAG/TaskNode.css</files>
  <action>
    Add analysis visual effects:
    1. Add `.task-node--analyzing` class with pulsing glow animation
    2. Update `.task-node--needs_analysis` with purple border/glow (rgb(147, 51, 234))
    3. Add `.task-node__analysis-icon` styling (position next to badge)
    4. Add `@keyframes pulse-analysis` animation (subtle purple glow pulse)
    5. Respect reduced motion preference
  </action>
  <verify>CSS loads, animations work</verify>
  <done>Analysis tasks have distinct purple styling and animation</done>
</task>

<task type="auto">
  <name>Task 3: Wire isBeingAnalyzed in DAGView</name>
  <files>src/renderer/src/views/DAGView.tsx</files>
  <action>
    Pass analysis state to TaskNode:
    1. Track currently analyzing task ID in state: `analyzingTaskId: string | null`
    2. Update from 'analyzing' event (set taskId), 'kept'/'split' events (clear)
    3. Update dagToNodes to include `isBeingAnalyzed: task.id === analyzingTaskId`
    4. Pass to TaskNodeData
  </action>
  <verify>Build passes, analyzing task pulses</verify>
  <done>Currently analyzing task shows pulsing animation</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` passes
- [ ] needs_analysis tasks show purple styling
- [ ] Currently analyzing task shows pulsing animation
- [ ] Tooltip shows "This task needs complexity analysis"
- [ ] Animation respects prefers-reduced-motion
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Clear visual distinction for needs_analysis tasks
- Animation feedback during analysis
</success_criteria>

<output>
After completion, create `.planning/phases/v3.1-03-ui-integration/03-03-SUMMARY.md`
</output>
