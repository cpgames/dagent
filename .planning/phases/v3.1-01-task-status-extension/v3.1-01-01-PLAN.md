---
phase: v3.1-01-task-status-extension
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/shared/types/task.ts
  - src/renderer/src/components/DAG/TaskNode.tsx
  - src/renderer/src/components/DAG/TaskNode.css
autonomous: true
must_haves:
  truths:
    - "Tasks can have needs_analysis status"
    - "needs_analysis tasks display with distinct purple/violet styling"
    - "Status badge shows 'NEEDS ANALYSIS' label"
  artifacts:
    - path: "src/shared/types/task.ts"
      provides: "TaskStatus type with needs_analysis"
      contains: "needs_analysis"
    - path: "src/renderer/src/components/DAG/TaskNode.tsx"
      provides: "Badge config for needs_analysis"
      contains: "needs_analysis"
    - path: "src/renderer/src/components/DAG/TaskNode.css"
      provides: "Styling for needs_analysis badge"
      contains: "task-node__badge--needs-analysis"
  key_links:
    - from: "task.ts TaskStatus"
      to: "TaskNode statusBadgeConfig"
      via: "Record<TaskStatus, ...>"
      pattern: "needs_analysis.*cssClass"
---

<objective>
Add `needs_analysis` status to TaskStatus type and update UI to display it.

Purpose: Enable tasks to be marked as needing PM complexity analysis before becoming ready for development.
Output: Updated task types with new status, TaskNode component with distinct styling for analysis-pending tasks.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/milestones/v3.1-task-analysis-orchestrator-ROADMAP.md

@src/shared/types/task.ts
@src/renderer/src/components/DAG/TaskNode.tsx
@src/renderer/src/components/DAG/TaskNode.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add needs_analysis to TaskStatus type</name>
  <files>src/shared/types/task.ts</files>
  <action>
    1. Add 'needs_analysis' to the TaskStatus union type as the FIRST status (before 'blocked')
       - This represents the initial state for tasks that need PM complexity analysis
    2. Add entry to TASK_STATUS_LABELS record:
       - Key: 'needs_analysis'
       - Value: 'Needs Analysis'

    The new status flow will be:
    needs_analysis â†’ blocked/ready_for_dev (after analysis)

    Keep all existing statuses unchanged to maintain backward compatibility.
  </action>
  <verify>TypeScript compiles: `npx tsc --noEmit`</verify>
  <done>TaskStatus includes 'needs_analysis', TASK_STATUS_LABELS has matching entry</done>
</task>

<task type="auto">
  <name>Task 2: Add needs_analysis badge config to TaskNode</name>
  <files>src/renderer/src/components/DAG/TaskNode.tsx</files>
  <action>
    1. Add entry to statusBadgeConfig for 'needs_analysis':
       ```typescript
       needs_analysis: { label: 'NEEDS ANALYSIS', cssClass: 'task-node__badge--needs-analysis' }
       ```

    2. Add the entry at the TOP of the config object (before 'blocked') to match the type definition order.

    The badge should indicate that this task is awaiting PM complexity analysis.
  </action>
  <verify>TypeScript compiles, no type errors about missing status</verify>
  <done>statusBadgeConfig includes needs_analysis entry with label and cssClass</done>
</task>

<task type="auto">
  <name>Task 3: Add needs_analysis badge styling</name>
  <files>src/renderer/src/components/DAG/TaskNode.css</files>
  <action>
    1. Add CSS class for the needs_analysis badge after the existing badge classes:
       ```css
       .task-node__badge--needs-analysis {
         background: rgba(147, 51, 234, 0.3);
         color: rgb(192, 132, 252);
       }
       ```

    Color rationale:
    - Purple/violet (#9333ea base) distinguishes from:
      - Cyan (blocked, ready)
      - Blue (dev)
      - Orange (qa)
      - Pink (merge)
      - Green (completed)
      - Red (failed)
    - Uses purple-500 (#a855f7) dimmed for background
    - Uses purple-400 (#c084fc) for text for good contrast

    This creates a distinct "pending analysis" appearance that stands out from execution states.
  </action>
  <verify>CSS is valid, badge class is defined</verify>
  <done>task-node__badge--needs-analysis class added with purple/violet styling</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] TypeScript compilation passes (`npx tsc --noEmit`)
- [ ] TaskStatus type includes 'needs_analysis'
- [ ] TASK_STATUS_LABELS includes 'Needs Analysis' entry
- [ ] statusBadgeConfig in TaskNode.tsx includes needs_analysis
- [ ] TaskNode.css has .task-node__badge--needs-analysis class
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No errors or warnings introduced
- Type system is complete (no missing cases in switch statements or records)
</success_criteria>

<output>
After completion, create `.planning/phases/v3.1-01-task-status-extension/v3.1-01-01-SUMMARY.md`
</output>
