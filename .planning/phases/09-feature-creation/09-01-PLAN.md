---
phase: 09-feature-creation
plan: 01
type: execute
---

<objective>
Implement feature creation backend - storage method, IPC handler, and preload API.

Purpose: Enable the renderer to create new features through the established IPC pattern.
Output: Complete backend support for feature creation with git worktree integration.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./09-01-SUMMARY.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

**Prior phase:**
@.planning/phases/08-auth-fixes/08-03-SUMMARY.md

**Key files:**
@src/main/storage/feature-store.ts
@src/main/ipc/storage-handlers.ts
@src/preload/index.ts
@src/shared/types/feature.ts
@src/main/git/types.ts

**Patterns established:**
- FeatureStore methods return Promise<T> or Promise<T | null>
- IPC handlers follow `storage:*` naming convention
- Preload exposes typed methods via contextBridge
- Feature creation should call git:createFeatureWorktree for worktree setup
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add createFeature method to FeatureStore</name>
  <files>src/main/storage/feature-store.ts</files>
  <action>
Add a new `createFeature` method to FeatureStore class that:
1. Generates a feature ID using format `feature-{slug}` where slug is kebab-case name (e.g., "My Feature" -> "feature-my-feature")
2. Creates a Feature object with:
   - id: generated feature ID
   - name: provided name
   - status: 'not_started'
   - branchName: generated from getFeatureBranchName(id)
   - createdAt/updatedAt: current ISO timestamp
3. Calls saveFeature() to persist to storage
4. Returns the created Feature object

Import getFeatureBranchName from '../git/types' for branch name generation.
The method signature: `async createFeature(name: string): Promise<Feature>`
  </action>
  <verify>TypeScript compiles without errors: `npm run typecheck`</verify>
  <done>createFeature method exists and generates proper feature ID and branch name</done>
</task>

<task type="auto">
  <name>Task 2: Add IPC handler and preload method for createFeature</name>
  <files>src/main/ipc/storage-handlers.ts, src/preload/index.ts</files>
  <action>
In storage-handlers.ts:
1. Add new handler `storage:createFeature` that takes a name string
2. Calls getStore().createFeature(name) and returns the created Feature

In preload/index.ts:
1. Add `createFeature` method to storage object
2. Signature: `createFeature: (name: string): Promise<Feature>`
3. Calls ipcRenderer.invoke('storage:createFeature', name)
  </action>
  <verify>TypeScript compiles: `npm run typecheck`</verify>
  <done>IPC channel registered, preload method available on window.electronAPI.storage.createFeature</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run typecheck` passes
- [ ] `npm run build` succeeds
- [ ] FeatureStore.createFeature generates correct ID format (feature-kebab-name)
- [ ] IPC handler storage:createFeature registered
- [ ] Preload exposes storage.createFeature method
</verification>

<success_criteria>
- createFeature method implemented in FeatureStore
- IPC handler registered for storage:createFeature
- Preload API exposes createFeature to renderer
- TypeScript types are correct throughout
</success_criteria>

<output>
After completion, create `.planning/phases/09-feature-creation/09-01-SUMMARY.md`
</output>
