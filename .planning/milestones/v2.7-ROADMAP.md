# v2.7 Canvas Background System

Unify all background rendering into a single canvas layer with enhanced visual effects, replacing the current CSS-based background components with a performant canvas-based system.

## Phases

- [x] **Phase 83: Canvas Infrastructure** - useAnimationFrame hook, base canvas component, layer interface
- [x] **Phase 84: Sky & Starfield Layers** - Sky gradient and starfield layers (replace CSS Starfield)
- [x] **Phase 85: Horizon Glow Layer** - Horizon glow with pulsing animation (replace CSS Horizon)
- [x] **Phase 86: Grid Layer Integration** - Integrate SynthwaveGrid into unified canvas
- [ ] **Phase 87: Shooting Stars Layer** - Shooting stars with trails system
- [ ] **Phase 88: Terrain Silhouettes** - Parallax mountain/city silhouettes
- [ ] **Phase 89: Integration & Cleanup** - Final integration, CSS cleanup, performance optimization

## Phase Details

### Phase 83: Canvas Infrastructure
**Goal**: Establish core canvas animation infrastructure for all subsequent layers
**Depends on**: Nothing (first phase)
**Requirements**: INFRA-01, INFRA-02, INFRA-03, INFRA-04
**Success Criteria** (what must be TRUE):
  1. useAnimationFrame hook provides delta time and pause/resume
  2. Base canvas component handles resize with devicePixelRatio
  3. Layer interface allows independent layer development
  4. Reduced motion query stops animation and shows static fallback
**Research**: Unlikely (patterns established in Phase 82 SynthwaveGrid)
**Plans**: 83-01 (4 tasks)

### Phase 84: Sky & Starfield Layers
**Goal**: Render sky gradient and animated starfield on canvas
**Depends on**: Phase 83
**Requirements**: VFX-01, VFX-02
**Success Criteria** (what must be TRUE):
  1. Sky gradient renders from deep purple to pink
  2. 360 stars render with varying sizes (0.5-2.2px)
  3. Stars flicker with sinusoidal animation
  4. Starfield renders above sky gradient
**Research**: Unlikely (specs defined in research)
**Plans**: TBD

### Phase 85: Horizon Glow Layer
**Goal**: Render horizon glow with pulsing intensity animation
**Depends on**: Phase 84
**Requirements**: VFX-03
**Success Criteria** (what must be TRUE):
  1. Horizon glow renders as radial gradient at 60-70% viewport height
  2. Glow pulses between 0.3-0.8 intensity with sinusoidal animation
  3. Pink/magenta colors match synthwave palette
  4. Glow renders below grid but above starfield
**Research**: Unlikely (specs defined in research)
**Plans**: TBD

### Phase 86: Grid Layer Integration
**Goal**: Integrate existing SynthwaveGrid into unified canvas
**Depends on**: Phase 85
**Requirements**: VFX-04
**Success Criteria** (what must be TRUE):
  1. Grid renders with curved horizontal lines (quadratic bezier)
  2. Grid scrolls toward viewer with smooth animation
  3. Grid uses cyan/magenta colors for lines
  4. Grid renders above horizon glow
**Research**: Unlikely (existing code in SynthwaveGrid.tsx)
**Plans**: TBD

### Phase 87: Shooting Stars Layer
**Goal**: Add shooting stars with trails as top visual layer
**Depends on**: Phase 86
**Requirements**: VFX-05
**Success Criteria** (what must be TRUE):
  1. Shooting stars spawn at ~1% chance per frame
  2. Maximum 3 concurrent shooting stars
  3. Trails are 35-50px with gradient fade
  4. Stars move diagonally across upper viewport
**Research**: Unlikely (specs defined in research)
**Plans**: TBD

### Phase 88: Terrain Silhouettes
**Goal**: Add terrain silhouettes with parallax depth effect
**Depends on**: Phase 87
**Requirements**: VFX-06
**Success Criteria** (what must be TRUE):
  1. 2-3 terrain layers render as black silhouettes
  2. Layers move at different speeds (parallax effect)
  3. Optional cyan edge glow on terrain edges
  4. Terrain renders between horizon glow and grid
**Research**: Unlikely (specs defined in research)
**Plans**: TBD

### Phase 89: Integration & Cleanup
**Goal**: Replace CSS components with unified canvas, optimize performance
**Depends on**: Phase 88
**Requirements**: INT-01, INT-02, INT-03, PERF-01, PERF-02, PERF-03
**Success Criteria** (what must be TRUE):
  1. Single canvas replaces all CSS background components
  2. One requestAnimationFrame loop drives all layers
  3. CSS Starfield and Horizon components removed
  4. Object pooling prevents GC pressure during animation
  5. GPU context loss handled gracefully
**Research**: Unlikely (integration work)
**Plans**: TBD

## Progress

| Phase | Plans | Status | Completed |
|-------|-------|--------|-----------|
| 83. Canvas Infrastructure | 1 | Complete | 2026-01-16 |
| 84. Sky & Starfield Layers | 1 | Complete | 2026-01-16 |
| 85. Horizon Glow Layer | 1 | Complete | 2026-01-16 |
| 86. Grid Layer Integration | 1 | Complete | 2026-01-16 |
| 87. Shooting Stars Layer | TBD | Not started | - |
| 88. Terrain Silhouettes | TBD | Not started | - |
| 89. Integration & Cleanup | TBD | Not started | - |

**Total**: 7 phases
